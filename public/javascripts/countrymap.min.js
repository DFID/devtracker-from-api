!function(t,e){function a(t){return["<div class='location-popup'>","<div class='row'>","<div class='four columns location-label'> Name </div>","<div class='eight columns'>",t.name[0].narratives[0].text,"</div>","</div>","</div>"].join("")}function o(t){for(var e=[],a=0;a<t.length;a++){var o=t[a];e.push(["<div class='row'>","<div class='five columns location-label'>","<a href='/projects/",o.id,"'>",o.id,"</a>","</div>","<div class='seven columns'>",o.title,"</div>","</div>"].join(""))}return["<div class='location-popup large'>",e.join(""),"</div>"].join("")}var n,r=$("#countryName").val(),i=$("#countryCode").val(),p=$("#projectType").val(),s=(L.tileLayer("http://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>, Tiles courtesy of <a href="http://hot.openstreetmap.org/" target="_blank">Humanitarian OpenStreetMap Team</a>'}),'Tiles &copy; <a href="http://www.mapquest.com/" target="_blank">MapQuest</a> <img src="http://developer.mapquest.com/content/osm/mq_logo.png" />'),l=(L.tileLayer("http://otile{s}.mqcdn.com/tiles/1.0.0/{type}/{z}/{x}/{y}.png",{options:{subdomains:"1234",type:"osm",attribution:"Map data "+L.TileLayer.OSM_ATTR+", "+s}}),L.tileLayer("http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'}),L.tileLayer("https://api.mapbox.com/v4/mapbox.emerald/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiZGV2dHJhY2tlciIsImEiOiJjaWhzdnplbzUwMDJ3dzRrcGVyN2licGFpIn0.a3sZ1t6v-N1nxFCDIiGblQ",{attribution:'&copy; <a href="https://www.mapbox.com/map-feedback/">Mapbox</a> &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}));if("global"==p)n=new L.Map("countryMap",{center:new L.LatLng(7.79,21.28),zoom:1,layers:[l]});else if("country"==p&&r&&i)n=new L.Map("countryMap",{center:new L.LatLng(countryBounds[i][0],countryBounds[i][1]),zoom:countryBounds[i][2]||6,layers:[l]});else if("region"==p&&i){var c=regionBounds[i],u=new L.LatLngBounds(new L.LatLng(c.southwest.lat,c.southwest.lng),new L.LatLng(c.northeast.lat,c.northeast.lng));n=new L.Map("countryMap",{layers:[l]}),n.fitBounds(u),n.panInsideBounds(u)}else $("#countryMap").hide(),$("#countryMapDisclaimer").hide();if(n&&t.locations){var d=new L.MarkerClusterGroup({spiderfyOnMaxZoom:!1,showCoverageOnHover:!1,singleMarkerMode:!0,iconCreateFunction:function(t){var e=t.getChildCount(),a="";return e>99&&(e="+",a="large-value"),new L.DivIcon({html:'<div class="marker cluster '+a+'">'+e+"</div>"})}});d.on("clusterclick",function(t){var e=t.target._zoom==t.target._maxZoom;if(e){for(var a=[],r=0;r<t.layer._markers.length;r++)a.push(t.layer._markers[r].options.data);var i=o(a);L.popup().setLatLng(t.layer._latlng).setContent(i).openOn(n)}});for(var m=0;m<locations.length;m++){var y=locations[m],h=new L.LatLng(y.point.pos.latitude,y.point.pos.longitude),v=new L.Marker(h,{title:y.name[0].narratives[0].text,data:y});switch(mapType){case"country":v.bindPopup(o([y]));break;case"project":v.bindPopup(a(y))}d.addLayer(v)}n.addLayer(d)}}(this);