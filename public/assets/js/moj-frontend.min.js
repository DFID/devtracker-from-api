!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.MOJFrontend=e()}(this,function(){var r={removeAttributeValue:function(t,e,o){var i;t.getAttribute(e)&&(t.getAttribute(e)==o?t.removeAttribute(e):(o=new RegExp("(^|\\s)"+o+"(\\s|$)"),(i=t.getAttribute(e).match(o))&&3==i.length&&t.setAttribute(e,t.getAttribute(e).replace(o,i[1]&&i[2]?" ":""))))},addAttributeValue:function(t,e,o){t.getAttribute(e)?new RegExp("(^|\\s)"+o+"(\\s|$)").test(t.getAttribute(e))||t.setAttribute(e,t.getAttribute(e)+" "+o):t.setAttribute(e,o)},dragAndDropSupported:function(){return"undefined"!=typeof document.createElement("div").ondrop},formDataSupported:function(){return"function"==typeof FormData},fileApiSupported:function(){var t=document.createElement("input");return t.type="file","undefined"!=typeof t.files},nodeListForEach:function(t,e){if(window.NodeList.prototype.forEach)return t.forEach(e);for(var o=0;o<t.length;o++)e.call(window,t[o],o,t)},initAll:function(t){var t="undefined"!=typeof(t=void 0!==t?t:{}).scope?t.scope:document,e=t.querySelectorAll('[data-module="moj-add-another"]'),e=(r.nodeListForEach(e,function(t){new r.AddAnother(t)}),t.querySelectorAll('[data-module="moj-multi-select"]')),e=(r.nodeListForEach(e,function(t){new r.MultiSelect({container:t.querySelector(t.getAttribute("data-multi-select-checkbox")),checkboxes:t.querySelectorAll("tbody .govuk-checkboxes__input")})}),t.querySelectorAll('[data-module="moj-password-reveal"]')),e=(r.nodeListForEach(e,function(t){new r.PasswordReveal(t)}),t.querySelectorAll('[data-module="moj-rich-text-editor"]')),e=(r.nodeListForEach(e,function(t){var e={textarea:$(t)},t=t.getAttribute("data-moj-rich-text-editor-toolbar");if(t){var o,i=t.split(",");for(o in e.toolbar={},i)e.toolbar[i[o]]=!0}new r.RichTextEditor(e)}),t.querySelectorAll('[data-module="moj-search-toggle"]')),e=(r.nodeListForEach(e,function(t){new r.SearchToggle({toggleButton:{container:$(t.querySelector(".moj-search-toggle__toggle")),text:t.getAttribute("data-moj-search-toggle-text")},search:{container:$(t.querySelector(".moj-search"))}})}),t.querySelectorAll('[data-module="moj-sortable-table"]')),e=(r.nodeListForEach(e,function(t){new r.SortableTable({table:t})}),t.querySelectorAll('[data-module="moj-sortable-table"]'));r.nodeListForEach(e,function(t){new r.SortableTable({table:t})})},AddAnother:function(t){this.container=$(t),this.container.data("moj-add-another-initialised")||(this.container.data("moj-add-another-initialised",!0),this.container.on("click",".moj-add-another__remove-button",$.proxy(this,"onRemoveButtonClick")),this.container.on("click",".moj-add-another__add-button",$.proxy(this,"onAddButtonClick")),this.container.find(".moj-add-another__add-button, moj-add-another__remove-button").prop("type","button"))}};return r.AddAnother.prototype.onAddButtonClick=function(t){var e=this.getNewItem(),o=(this.updateAttributes(this.getItems().length,e),this.resetItem(e),this.getItems().first());this.hasRemoveButton(o)||this.createRemoveButton(o),this.getItems().last().after(e),e.find("input, textarea, select").first().focus()},r.AddAnother.prototype.hasRemoveButton=function(t){return t.find(".moj-add-another__remove-button").length},r.AddAnother.prototype.getItems=function(){return this.container.find(".moj-add-another__item")},r.AddAnother.prototype.getNewItem=function(){var t=this.getItems().first().clone();return this.hasRemoveButton(t)||this.createRemoveButton(t),t},r.AddAnother.prototype.updateAttributes=function(i,n){n.find("[data-name]").each(function(t,e){var o=e.id;e.name=$(e).attr("data-name").replace(/%index%/,i),e.id=$(e).attr("data-id").replace(/%index%/,i),($(e).siblings("label")[0]||$(e).parents("label")[0]||n.find('[for="'+o+'"]')[0]).htmlFor=e.id})},r.AddAnother.prototype.createRemoveButton=function(t){t.append('<button type="button" class="govuk-button govuk-button--secondary moj-add-another__remove-button">Remove</button>')},r.AddAnother.prototype.resetItem=function(t){t.find("[data-name], [data-id]").each(function(t,e){"checkbox"==e.type||"radio"==e.type?e.checked=!1:e.value=""})},r.AddAnother.prototype.onRemoveButtonClick=function(t){$(t.currentTarget).parents(".moj-add-another__item").remove();t=this.getItems();1===t.length&&t.find(".moj-add-another__remove-button").remove(),t.each($.proxy(function(t,e){this.updateAttributes(t,$(e))},this)),this.focusHeading()},r.AddAnother.prototype.focusHeading=function(){this.container.find(".moj-add-another__heading").focus()},r.ButtonMenu=function(t){this.container=t.container,this.menu=this.container.find(".moj-button-menu__wrapper"),t.menuClasses&&this.menu.addClass(t.menuClasses),this.menu.attr("role","menu"),this.mq=t.mq,this.buttonText=t.buttonText,this.buttonClasses=t.buttonClasses||"",this.keys={esc:27,up:38,down:40,tab:9},this.menu.on("keydown","[role=menuitem]",$.proxy(this,"onButtonKeydown")),this.createToggleButton(),this.setupResponsiveChecks(),$(document).on("click",$.proxy(this,"onDocumentClick"))},r.ButtonMenu.prototype.onDocumentClick=function(t){$.contains(this.container[0],t.target)||this.hideMenu()},r.ButtonMenu.prototype.createToggleButton=function(){this.menuButton=$('<button class="govuk-button moj-button-menu__toggle-button '+this.buttonClasses+'" type="button" aria-haspopup="true" aria-expanded="false">'+this.buttonText+"</button>"),this.menuButton.on("click",$.proxy(this,"onMenuButtonClick")),this.menuButton.on("keydown",$.proxy(this,"onMenuKeyDown"))},r.ButtonMenu.prototype.setupResponsiveChecks=function(){this.mql=window.matchMedia(this.mq),this.mql.addListener($.proxy(this,"checkMode")),this.checkMode(this.mql)},r.ButtonMenu.prototype.checkMode=function(t){t.matches?this.enableBigMode():this.enableSmallMode()},r.ButtonMenu.prototype.enableSmallMode=function(){this.container.prepend(this.menuButton),this.hideMenu(),this.removeButtonClasses(),this.menu.attr("role","menu"),this.container.find(".moj-button-menu__item").attr("role","menuitem")},r.ButtonMenu.prototype.enableBigMode=function(){this.menuButton.detach(),this.showMenu(),this.addButtonClasses(),this.menu.removeAttr("role"),this.container.find(".moj-button-menu__item").removeAttr("role")},r.ButtonMenu.prototype.removeButtonClasses=function(){this.menu.find(".moj-button-menu__item").each(function(t,e){$(e).hasClass("govuk-button--secondary")&&($(e).attr("data-secondary","true"),$(e).removeClass("govuk-button--secondary")),$(e).hasClass("govuk-button--warning")&&($(e).attr("data-warning","true"),$(e).removeClass("govuk-button--warning")),$(e).removeClass("govuk-button")})},r.ButtonMenu.prototype.addButtonClasses=function(){this.menu.find(".moj-button-menu__item").each(function(t,e){"true"==$(e).attr("data-secondary")&&$(e).addClass("govuk-button--secondary"),"true"==$(e).attr("data-warning")&&$(e).addClass("govuk-button--warning"),$(e).addClass("govuk-button")})},r.ButtonMenu.prototype.hideMenu=function(){this.menuButton.attr("aria-expanded","false")},r.ButtonMenu.prototype.showMenu=function(){this.menuButton.attr("aria-expanded","true")},r.ButtonMenu.prototype.onMenuButtonClick=function(){this.toggle()},r.ButtonMenu.prototype.toggle=function(){"false"==this.menuButton.attr("aria-expanded")?(this.showMenu(),this.menu.find("[role=menuitem]").first().focus()):(this.hideMenu(),this.menuButton.focus())},r.ButtonMenu.prototype.onMenuKeyDown=function(t){t.keyCode===this.keys.down&&this.toggle()},r.ButtonMenu.prototype.onButtonKeydown=function(t){switch(t.keyCode){case this.keys.up:t.preventDefault(),this.focusPrevious(t.currentTarget);break;case this.keys.down:t.preventDefault(),this.focusNext(t.currentTarget);break;case this.keys.esc:this.mq.matches||(this.menuButton.focus(),this.hideMenu());break;case this.keys.tab:this.mq.matches||this.hideMenu()}},r.ButtonMenu.prototype.focusNext=function(t){t=$(t).next();(t[0]?t:this.container.find("[role=menuitem]").first()).focus()},r.ButtonMenu.prototype.focusPrevious=function(t){t=$(t).prev();(t[0]?t:this.container.find("[role=menuitem]").last()).focus()},r.FilterToggleButton=function(t){this.options=t,this.container=this.options.toggleButton.container,this.createToggleButton(),this.setupResponsiveChecks(),this.options.filter.container.attr("tabindex","-1"),this.options.startHidden&&this.hideMenu()},r.FilterToggleButton.prototype.setupResponsiveChecks=function(){this.mq=window.matchMedia(this.options.bigModeMediaQuery),this.mq.addListener($.proxy(this,"checkMode")),this.checkMode(this.mq)},r.FilterToggleButton.prototype.createToggleButton=function(){this.menuButton=$('<button class="govuk-button '+this.options.toggleButton.classes+'" type="button" aria-haspopup="true" aria-expanded="false">'+this.options.toggleButton.showText+"</button>"),this.menuButton.on("click",$.proxy(this,"onMenuButtonClick")),this.options.toggleButton.container.append(this.menuButton)},r.FilterToggleButton.prototype.checkMode=function(t){t.matches?this.enableBigMode():this.enableSmallMode()},r.FilterToggleButton.prototype.enableBigMode=function(){this.showMenu(),this.removeCloseButton()},r.FilterToggleButton.prototype.enableSmallMode=function(){this.hideMenu(),this.addCloseButton()},r.FilterToggleButton.prototype.addCloseButton=function(){this.options.closeButton&&(this.closeButton=$('<button class="moj-filter__close" type="button">'+this.options.closeButton.text+"</button>"),this.closeButton.on("click",$.proxy(this,"onCloseClick")),this.options.closeButton.container.append(this.closeButton))},r.FilterToggleButton.prototype.onCloseClick=function(){this.hideMenu(),this.menuButton.focus()},r.FilterToggleButton.prototype.removeCloseButton=function(){this.closeButton&&(this.closeButton.remove(),this.closeButton=null)},r.FilterToggleButton.prototype.hideMenu=function(){this.menuButton.attr("aria-expanded","false"),this.options.filter.container.addClass("moj-js-hidden"),this.menuButton.text(this.options.toggleButton.showText)},r.FilterToggleButton.prototype.showMenu=function(){this.menuButton.attr("aria-expanded","true"),this.options.filter.container.removeClass("moj-js-hidden"),this.menuButton.text(this.options.toggleButton.hideText)},r.FilterToggleButton.prototype.onMenuButtonClick=function(){this.toggle()},r.FilterToggleButton.prototype.toggle=function(){"false"==this.menuButton.attr("aria-expanded")?(this.showMenu(),this.options.filter.container.focus()):this.hideMenu()},r.FormValidator=function(t,e){this.form=t,this.errors=[],this.validators=[],$(this.form).on("submit",$.proxy(this,"onSubmit")),this.summary=e&&e.summary?$(e.summary):$(".govuk-error-summary"),this.originalTitle=document.title},r.FormValidator.entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},r.FormValidator.prototype.escapeHtml=function(t){return String(t).replace(/[&<>"'`=\/]/g,function(t){return r.FormValidator.entityMap[t]})},r.FormValidator.prototype.resetTitle=function(){document.title=this.originalTitle},r.FormValidator.prototype.updateTitle=function(){document.title=this.errors.length+" errors - "+document.title},r.FormValidator.prototype.showSummary=function(){this.summary.html(this.getSummaryHtml()),this.summary.removeClass("moj-hidden"),this.summary.attr("aria-labelledby","errorSummary-heading"),this.summary.focus()},r.FormValidator.prototype.getSummaryHtml=function(){i='<h2 id="error-summary-title" class="govuk-error-summary__title">There is a problem</h2><div class="govuk-error-summary__body"><ul class="govuk-list govuk-error-summary__list">';for(var t=0,e=this.errors.length;t<e;t++)var o=this.errors[t],i=(i=(i=(i+="<li>")+('<a href="#'+this.escapeHtml(o.fieldName)+'">'))+this.escapeHtml(o.message))+"</a>"+"</li>";return i=i+"</ul>"+"</div>"},r.FormValidator.prototype.hideSummary=function(){this.summary.addClass("moj-hidden"),this.summary.removeAttr("aria-labelledby")},r.FormValidator.prototype.onSubmit=function(t){this.removeInlineErrors(),this.hideSummary(),this.resetTitle(),this.validate()||(t.preventDefault(),this.updateTitle(),this.showSummary(),this.showInlineErrors())},r.FormValidator.prototype.showInlineErrors=function(){for(var t=0,e=this.errors.length;t<e;t++)this.showInlineError(this.errors[t])},r.FormValidator.prototype.showInlineError=function(t){var e=t.fieldName+"-error",o='<span class="govuk-error-message" id="'+e+'">'+this.escapeHtml(t.message)+"</span>",t=$("#"+t.fieldName),i=t.parents(".govuk-form-group"),n=i.find("label"),a=i.find("legend"),s=i.find("fieldset");i.addClass("govuk-form-group--error"),a.length?(a.after(o),i.attr("aria-invalid","true"),r.addAttributeValue(s[0],"aria-describedby",e)):(n.after(o),t.attr("aria-invalid","true"),r.addAttributeValue(t[0],"aria-describedby",e))},r.FormValidator.prototype.removeInlineErrors=function(){for(var t=0;t<this.errors.length;t++)this.removeInlineError(this.errors[t])},r.FormValidator.prototype.removeInlineError=function(t){var e=$("#"+t.fieldName).parents(".govuk-form-group"),t=(e.find(".govuk-error-message").remove(),e.removeClass("govuk-form-group--error"),e.find("[aria-invalid]").attr("aria-invalid","false"),t.fieldName+"-error");r.removeAttributeValue(e.find("[aria-describedby]")[0],"aria-describedby",t)},r.FormValidator.prototype.addValidator=function(t,e){this.validators.push({fieldName:t,rules:e,field:this.form.elements[t]})},r.FormValidator.prototype.validate=function(){this.errors=[];for(var t,e,o=null,i=0;i<this.validators.length;i++)for(o=this.validators[i],e=0;e<o.rules.length;e++){if("boolean"==typeof(t=o.rules[e].method(o.field,o.rules[e].params))&&!t){this.errors.push({fieldName:o.fieldName,message:o.rules[e].message});break}if("string"==typeof t){this.errors.push({fieldName:t,message:o.rules[e].message});break}}return 0===this.errors.length},r.dragAndDropSupported()&&r.formDataSupported()&&r.fileApiSupported()&&(r.MultiFileUpload=function(t){this.defaultParams={uploadFileEntryHook:$.noop,uploadFileExitHook:$.noop,uploadFileErrorHook:$.noop,fileDeleteHook:$.noop,uploadStatusText:"Uploading files, please wait",dropzoneHintText:"Drag and drop files here or",dropzoneButtonText:"Choose files"},this.params=$.extend({},this.defaultParams,t),this.params.container.addClass("moj-multi-file-upload--enhanced"),this.feedbackContainer=this.params.container.find(".moj-multi-file__uploaded-files"),this.setupFileInput(),this.setupDropzone(),this.setupLabel(),this.setupStatusBox(),this.params.container.on("click",".moj-multi-file-upload__delete",$.proxy(this,"onFileDeleteClick"))},r.MultiFileUpload.prototype.setupDropzone=function(){this.fileInput.wrap('<div class="moj-multi-file-upload__dropzone" />'),this.dropzone=this.params.container.find(".moj-multi-file-upload__dropzone"),this.dropzone.on("dragover",$.proxy(this,"onDragOver")),this.dropzone.on("dragleave",$.proxy(this,"onDragLeave")),this.dropzone.on("drop",$.proxy(this,"onDrop"))},r.MultiFileUpload.prototype.setupLabel=function(){this.label=$('<label for="'+this.fileInput[0].id+'" class="govuk-button govuk-button--secondary">'+this.params.dropzoneButtonText+"</label>"),this.dropzone.append('<p class="govuk-body">'+this.params.dropzoneHintText+"</p>"),this.dropzone.append(this.label)},r.MultiFileUpload.prototype.setupFileInput=function(){this.fileInput=this.params.container.find(".moj-multi-file-upload__input"),this.fileInput.on("change",$.proxy(this,"onFileChange")),this.fileInput.on("focus",$.proxy(this,"onFileFocus")),this.fileInput.on("blur",$.proxy(this,"onFileBlur"))},r.MultiFileUpload.prototype.setupStatusBox=function(){this.status=$('<div aria-live="polite" role="status" class="govuk-visually-hidden" />'),this.dropzone.append(this.status)},r.MultiFileUpload.prototype.onDragOver=function(t){t.preventDefault(),this.dropzone.addClass("moj-multi-file-upload--dragover")},r.MultiFileUpload.prototype.onDragLeave=function(){this.dropzone.removeClass("moj-multi-file-upload--dragover")},r.MultiFileUpload.prototype.onDrop=function(t){t.preventDefault(),this.dropzone.removeClass("moj-multi-file-upload--dragover"),this.feedbackContainer.removeClass("moj-hidden"),this.status.html(this.params.uploadStatusText),this.uploadFiles(t.originalEvent.dataTransfer.files)},r.MultiFileUpload.prototype.uploadFiles=function(t){for(var e=0;e<t.length;e++)this.uploadFile(t[e])},r.MultiFileUpload.prototype.onFileChange=function(t){this.feedbackContainer.removeClass("moj-hidden"),this.status.html(this.params.uploadStatusText),this.uploadFiles(t.currentTarget.files),this.fileInput.replaceWith($(t.currentTarget).val("").clone(!0)),this.setupFileInput(),this.fileInput.focus()},r.MultiFileUpload.prototype.onFileFocus=function(t){this.label.addClass("moj-multi-file-upload--focused")},r.MultiFileUpload.prototype.onFileBlur=function(t){this.label.removeClass("moj-multi-file-upload--focused")},r.MultiFileUpload.prototype.getSuccessHtml=function(t){return'<span class="moj-multi-file-upload__success"> <svg class="moj-banner__icon" fill="currentColor" role="presentation" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25" height="25" width="25"><path d="M25,6.2L8.7,23.2L0,14.1l4-4.2l4.7,4.9L21,2L25,6.2z"/></svg> '+t.messageHtml+"</span>"},r.MultiFileUpload.prototype.getErrorHtml=function(t){return'<span class="moj-multi-file-upload__error"> <svg class="moj-banner__icon" fill="currentColor" role="presentation" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25" height="25" width="25"><path d="M13.6,15.4h-2.3v-4.5h2.3V15.4z M13.6,19.8h-2.3v-2.2h2.3V19.8z M0,23.2h25L12.5,2L0,23.2z"/></svg> '+t.message+"</span>"},r.MultiFileUpload.prototype.getFileRowHtml=function(t){var e="";return(e+='<div class="govuk-summary-list__row moj-multi-file-upload__row">')+'  <div class="govuk-summary-list__value moj-multi-file-upload__message">'+('<span class="moj-multi-file-upload__filename">'+t.name+"</span>")+'<span class="moj-multi-file-upload__progress">0%</span>'+"  </div>"+'  <div class="govuk-summary-list__actions moj-multi-file-upload__actions"></div>'+"</div>"},r.MultiFileUpload.prototype.getDeleteButtonHtml=function(t){var e='<button class="moj-multi-file-upload__delete govuk-button govuk-button--secondary govuk-!-margin-bottom-0" type="button" name="delete" value="'+t.filename+'">';return e+('Delete <span class="govuk-visually-hidden">'+t.originalname+"</span>")+"</button>"},r.MultiFileUpload.prototype.uploadFile=function(i){this.params.uploadFileEntryHook(this,i);var t=new FormData,e=(t.append("documents",i),$(this.getFileRowHtml(i)));this.feedbackContainer.find(".moj-multi-file-upload__list").append(e),$.ajax({url:this.params.uploadUrl,type:"post",data:t,processData:!1,contentType:!1,success:$.proxy(function(t){t.error?(e.find(".moj-multi-file-upload__message").html(this.getErrorHtml(t.error)),this.status.html(t.error.message)):(e.find(".moj-multi-file-upload__message").html(this.getSuccessHtml(t.success)),this.status.html(t.success.messageText)),e.find(".moj-multi-file-upload__actions").append(this.getDeleteButtonHtml(t.file)),this.params.uploadFileExitHook(this,i,t)},this),error:$.proxy(function(t,e,o){this.params.uploadFileErrorHook(this,i,t,e,o)},this),xhr:function(){var t=new XMLHttpRequest;return t.upload.addEventListener("progress",function(t){t.lengthComputable&&(t=t.loaded/t.total,t=parseInt(100*t,10),e.find(".moj-multi-file-upload__progress").text(" "+t+"%"))},!1),t}})},r.MultiFileUpload.prototype.onFileDeleteClick=function(t){t.preventDefault();var e=$(t.currentTarget),t={};t[e[0].name]=e[0].value,$.ajax({url:this.params.deleteUrl,type:"post",dataType:"json",data:t,success:$.proxy(function(t){t.error||(e.parents(".moj-multi-file-upload__row").remove(),0===this.feedbackContainer.find(".moj-multi-file-upload__row").length&&this.feedbackContainer.addClass("moj-hidden")),this.params.fileDeleteHook(this,t)},this)})}),r.MultiSelect=function(t){this.container=$(t.container),this.container.data("moj-multi-select-initialised")||(this.container.data("moj-multi-select-initialised",!0),this.toggle=$(this.getToggleHtml()),this.toggleButton=this.toggle.find("input"),this.toggleButton.on("click",$.proxy(this,"onButtonClick")),this.container.append(this.toggle),this.checkboxes=$(t.checkboxes),this.checkboxes.on("click",$.proxy(this,"onCheckboxClick")),this.checked=t.checked||!1)},r.MultiSelect.prototype.getToggleHtml=function(){return'<div class="govuk-checkboxes__item govuk-checkboxes--small moj-multi-select__checkbox">  <input type="checkbox" class="govuk-checkboxes__input" id="checkboxes-all">  <label class="govuk-label govuk-checkboxes__label moj-multi-select__toggle-label" for="checkboxes-all">    <span class="govuk-visually-hidden">Select all</span>  </label></div>'},r.MultiSelect.prototype.onButtonClick=function(t){this.checked?(this.uncheckAll(),this.toggleButton[0].checked=!1):(this.checkAll(),this.toggleButton[0].checked=!0)},r.MultiSelect.prototype.checkAll=function(){this.checkboxes.each($.proxy(function(t,e){e.checked=!0},this)),this.checked=!0},r.MultiSelect.prototype.uncheckAll=function(){this.checkboxes.each($.proxy(function(t,e){e.checked=!1},this)),this.checked=!1},r.MultiSelect.prototype.onCheckboxClick=function(t){t.target.checked?this.checkboxes.filter(":checked").length===this.checkboxes.length&&(this.toggleButton[0].checked=!0,this.checked=!0):(this.toggleButton[0].checked=!1,this.checked=!1)},r.PasswordReveal=function(t){this.el=t,($el=$(this.el)).data("moj-password-reveal-initialised")||($el.data("moj-password-reveal-initialised",!0),$el.attr("spellcheck","false"),$el.wrap('<div class="moj-password-reveal"></div>'),this.container=$(this.el).parent(),this.createButton())},r.PasswordReveal.prototype.createButton=function(){this.button=$('<button type="button" class="govuk-button govuk-button--secondary moj-password-reveal__button">Show <span class="govuk-visually-hidden">password</span></button>'),this.container.append(this.button),this.button.on("click",$.proxy(this,"onButtonClick"))},r.PasswordReveal.prototype.onButtonClick=function(){"password"===this.el.type?(this.el.type="text",this.button.html('Hide <span class="govuk-visually-hidden">password</span>')):(this.el.type="password",this.button.html('Show <span class="govuk-visually-hidden">password</span>'))},"contentEditable"in document.documentElement&&(r.RichTextEditor=function(t){this.options=t,this.options.toolbar=this.options.toolbar||{bold:!1,italic:!1,underline:!1,bullets:!0,numbers:!0},this.textarea=this.options.textarea,this.container=$(this.textarea).parent(),this.container.data("moj-rich-text-editor-initialised")||(this.container.data("moj-rich-text-editor-initialised",!0),this.createToolbar(),this.hideDefault(),this.configureToolbar(),this.keys={left:37,right:39,up:38,down:40},this.container.on("click",".moj-rich-text-editor__toolbar-button",$.proxy(this,"onButtonClick")),this.container.find(".moj-rich-text-editor__content").on("input",$.proxy(this,"onEditorInput")),this.container.find("label").on("click",$.proxy(this,"onLabelClick")),this.toolbar.on("keydown",$.proxy(this,"onToolbarKeydown")))},r.RichTextEditor.prototype.onToolbarKeydown=function(t){switch(t.keyCode){case this.keys.right:case this.keys.down:var e,o=(e=this.toolbar.find("button[tabindex=0]")).next("button");o[0]&&(o.focus(),e.attr("tabindex","-1"),o.attr("tabindex","0"));break;case this.keys.left:case this.keys.up:o=(e=this.toolbar.find("button[tabindex=0]")).prev("button");o[0]&&(o.focus(),e.attr("tabindex","-1"),o.attr("tabindex","0"))}},r.RichTextEditor.prototype.getToolbarHtml=function(){var t="";return t+='<div class="moj-rich-text-editor__toolbar" role="toolbar">',this.options.toolbar.bold&&(t+='<button class="moj-rich-text-editor__toolbar-button moj-rich-text-editor__toolbar-button--bold" type="button" data-command="bold"><span class="govuk-visually-hidden">Bold</span></button>'),this.options.toolbar.italic&&(t+='<button class="moj-rich-text-editor__toolbar-button moj-rich-text-editor__toolbar-button--italic" type="button" data-command="italic"><span class="govuk-visually-hidden">Italic</span></button>'),this.options.toolbar.underline&&(t+='<button class="moj-rich-text-editor__toolbar-button moj-rich-text-editor__toolbar-button--underline" type="button" data-command="underline"><span class="govuk-visually-hidden">Underline</span></button>'),this.options.toolbar.bullets&&(t+='<button class="moj-rich-text-editor__toolbar-button moj-rich-text-editor__toolbar-button--unordered-list" type="button" data-command="insertUnorderedList"><span class="govuk-visually-hidden">Unordered list</span></button>'),this.options.toolbar.numbers&&(t+='<button class="moj-rich-text-editor__toolbar-button moj-rich-text-editor__toolbar-button--ordered-list" type="button" data-command="insertOrderedList"><span class="govuk-visually-hidden">Ordered list</span></button>'),t+="</div>"},r.RichTextEditor.prototype.getEnhancedHtml=function(t){return this.getToolbarHtml()+'<div class="govuk-textarea moj-rich-text-editor__content" contenteditable="true" spellcheck="false"></div>'},r.RichTextEditor.prototype.hideDefault=function(){this.textarea=this.container.find("textarea"),this.textarea.addClass("govuk-visually-hidden"),this.textarea.attr("aria-hidden",!0),this.textarea.attr("tabindex","-1")},r.RichTextEditor.prototype.createToolbar=function(){this.toolbar=document.createElement("div"),this.toolbar.className="moj-rich-text-editor",this.toolbar.innerHTML=this.getEnhancedHtml(),this.container.append(this.toolbar),this.toolbar=this.container.find(".moj-rich-text-editor__toolbar"),this.container.find(".moj-rich-text-editor__content").html(this.textarea.val())},r.RichTextEditor.prototype.configureToolbar=function(){this.buttons=this.container.find(".moj-rich-text-editor__toolbar-button"),this.buttons.prop("tabindex","-1"),this.buttons.first().prop("tabindex","0")},r.RichTextEditor.prototype.onButtonClick=function(t){document.execCommand($(t.currentTarget).data("command"),!1,null)},r.RichTextEditor.prototype.getContent=function(){return this.container.find(".moj-rich-text-editor__content").html()},r.RichTextEditor.prototype.onEditorInput=function(t){this.updateTextarea()},r.RichTextEditor.prototype.updateTextarea=function(){document.execCommand("defaultParagraphSeparator",!1,"p"),this.textarea.val(this.getContent())},r.RichTextEditor.prototype.onLabelClick=function(t){t.preventDefault(),this.container.find(".moj-rich-text-editor__content").focus()}),r.SearchToggle=function(t){this.options=t,this.options.search.container.data("moj-search-toggle-initialised")||(this.options.search.container.data("moj-search-toggle-initialised",!0),this.toggleButton=$('<button class="moj-search-toggle__button" type="button" aria-haspopup="true" aria-expanded="false">'+this.options.toggleButton.text+'<svg viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="moj-search-toggle__button__icon"><path d="M7.433,12.5790048 C6.06762625,12.5808611 4.75763941,12.0392925 3.79217348,11.0738265 C2.82670755,10.1083606 2.28513891,8.79837375 2.28699522,7.433 C2.28513891,6.06762625 2.82670755,4.75763941 3.79217348,3.79217348 C4.75763941,2.82670755 6.06762625,2.28513891 7.433,2.28699522 C8.79837375,2.28513891 10.1083606,2.82670755 11.0738265,3.79217348 C12.0392925,4.75763941 12.5808611,6.06762625 12.5790048,7.433 C12.5808611,8.79837375 12.0392925,10.1083606 11.0738265,11.0738265 C10.1083606,12.0392925 8.79837375,12.5808611 7.433,12.5790048 L7.433,12.5790048 Z M14.293,12.579 L13.391,12.579 L13.071,12.269 C14.2300759,10.9245158 14.8671539,9.20813198 14.866,7.433 C14.866,3.32786745 11.5381325,-1.65045755e-15 7.433,-1.65045755e-15 C3.32786745,-1.65045755e-15 -1.65045755e-15,3.32786745 -1.65045755e-15,7.433 C-1.65045755e-15,11.5381325 3.32786745,14.866 7.433,14.866 C9.208604,14.8671159 10.9253982,14.2296624 12.27,13.07 L12.579,13.39 L12.579,14.294 L18.296,20 L20,18.296 L14.294,12.579 L14.293,12.579 Z"></path></svg></button>'),this.toggleButton.on("click",$.proxy(this,"onToggleButtonClick")),this.options.toggleButton.container.append(this.toggleButton))},r.SearchToggle.prototype.onToggleButtonClick=function(){"false"==this.toggleButton.attr("aria-expanded")?(this.toggleButton.attr("aria-expanded","true"),this.options.search.container.removeClass("moj-js-hidden"),this.options.search.container.find("input").first().focus()):(this.options.search.container.addClass("moj-js-hidden"),this.toggleButton.attr("aria-expanded","false"))},r.SortableTable=function(t){this.table=$(t.table),this.table.data("moj-search-toggle-initialised")||(this.table.data("moj-search-toggle-initialised",!0),this.setupOptions(t),this.body=this.table.find("tbody"),this.createHeadingButtons(),this.createStatusBox(),this.table.on("click","th button",$.proxy(this,"onSortButtonClick")))},r.SortableTable.prototype.setupOptions=function(t){this.statusMessage=(t=t||{}).statusMessage||"Sort by %heading% (%direction%)",this.ascendingText=t.ascendingText||"ascending",this.descendingText=t.descendingText||"descending"},r.SortableTable.prototype.createHeadingButtons=function(){for(var t,e=this.table.find("thead th"),o=0;o<e.length;o++)(t=$(e[o])).attr("aria-sort")&&this.createHeadingButton(t,o)},r.SortableTable.prototype.createHeadingButton=function(t,e){var o=t.text(),e=$('<button type="button" data-index="'+e+'">'+o+"</button>");t.text(""),t.append(e)},r.SortableTable.prototype.createStatusBox=function(){this.status=$('<div aria-live="polite" role="status" aria-atomic="true" class="govuk-visually-hidden" />'),this.table.parent().append(this.status)},r.SortableTable.prototype.onSortButtonClick=function(t){var e=t.currentTarget.getAttribute("data-index"),o=$(t.currentTarget).parent().attr("aria-sort"),o="none"===o||"descending"===o?"ascending":"descending",i=this.getTableRowsArray(),i=this.sort(i,e,o);this.addRows(i),this.removeButtonStates(),this.updateButtonState($(t.currentTarget),o)},r.SortableTable.prototype.updateButtonState=function(t,e){t.parent().attr("aria-sort",e);var o=this.statusMessage;o=(o=o.replace(/%heading%/,t.text())).replace(/%direction%/,this[e+"Text"]),this.status.text(o)},r.SortableTable.prototype.removeButtonStates=function(){this.table.find("thead th").attr("aria-sort","none")},r.SortableTable.prototype.addRows=function(t){for(var e=0;e<t.length;e++)this.body.append(t[e])},r.SortableTable.prototype.getTableRowsArray=function(){for(var t=[],e=this.body.find("tr"),o=0;o<e.length;o++)t.push(e[o]);return t},r.SortableTable.prototype.sort=function(t,o,i){return t.sort($.proxy(function(t,e){t=$(t).find("td").eq(o),e=$(e).find("td").eq(o),t=this.getCellValue(t),e=this.getCellValue(e);return"ascending"===i?t<e?-1:e<t?1:0:e<t?-1:t<e?1:0},this))},r.SortableTable.prototype.getCellValue=function(t){var e=(e=t.attr("data-sort-value"))||t.html();return e=$.isNumeric(e)?parseInt(e,10):e},r});