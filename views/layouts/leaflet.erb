<!--
published: true
title: Development Tracker
 -->
 <style>
     #mapid { height: 180px; }
   </style>
<div class="hero hero-notabs">
  <div id="page-title" class="row">
      <div class="twelve columns">
          <!-- <img src="/images/ukaid_logo.png" alt="UK aid from the British people"> -->
          <div>
              <div class="breadcrumb">
              <ul>
                  <li><a href="/">Home</a></li>
                  <li>Aid by Department</li>
              </ul>
          </div>
              <h1>
                  UK Government Spend
              </h1>
          </div>
          
      </div>
  </div>
</div>
<div class="row overview-text">
    <div class="twelve columns summary">
        <p>In the UK, the 0.7% commitment on ODA spend applies across government. DFID is the UK’s primary channel for aid but in response to the changing world, more aid is administered by other government departments, drawing on their complementary skills. To support the UK's cross government approach and to ensure a joined-up approach, there will also be several cross-government funds setup. Each departments is responsible for ensuring that their own ODA budgets are allocated optimally, spent well and published to IATI.</p>
    </div>
</div>

<div class="row">
    <div class="twelve columns">
        <h3 class="section-group-title">Projects by UK Government Department</h3>
    </div>
    <div class="twelve columns">
      <div id="countryMap"></div>
    </div>
</div>
<script type="text/javascript">
    var mapType = "country";
    var locations = "";<%#=locations.to_json%>
    window.reportingOrgs = "<%= settings.goverment_department_ids %>";
</script>
<script src="/javascripts/leaflet/countryBounds.js" type="text/javascript"></script>
<link rel="stylesheet" href="/javascripts/leaflet/MarkerCluster_new.css">
<link rel="stylesheet" href="/javascripts/leaflet/MarkerCluster.Default_new.css">
<script src="/javascripts/leaflet/leaflet.markercluster_new.js"></script>

 <script type="text/javascript">
  $(document).ready(function() {
    var countryCode = '<%=countryCode %>';

  // var mymap = L.map('countryMap').setView([51.505, -0.09], 13);

  // L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
  //   maxZoom: 18,
  //   attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
  //     '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
  //     'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
  //   id: 'mapbox.streets'
  // }).addTo(mymap);

    //var mymap = L.map('countryMap').setView([51.505, -0.09], 13);
    var layer = L.tileLayer('https://api.mapbox.com/v4/mapbox.emerald/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiZGV2dHJhY2tlciIsImEiOiJjaWhzdnplbzUwMDJ3dzRrcGVyN2licGFpIn0.a3sZ1t6v-N1nxFCDIiGblQ', {
              attribution: '&copy; <a href="https://www.mapbox.com/map-feedback/">Mapbox</a> &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
          });
    if (countryBounds[countryCode][2] != null){
      zoomFactor = countryBounds[countryCode][2];
    }
    else{
      zoomFactor = 6;
    }
    map = new L.Map('countryMap', {
        center: new L.LatLng(countryBounds[countryCode][0], countryBounds[countryCode][1]), 
        zoom: zoomFactor,  
        layers: [layer]
    });
    
    //var json = $.getJSON("/javascripts/leaflet/world.json");
    // var vtest = '';
    // console.log(testv2);
    // $.each(testv2.features,function(i,v){
    //   if(v.properties.ISO_A3 == "BGD"){
    //     vtest = v.geometry.coordinates
    //   }
    // });
    // console.log(vtest);
    //var polygon = L.polygon(vtest).addTo(map);

    var mapBorder = {
        "type": "Feature",
        "properties": {
            "popupContent": "This is the Auraria West Campus",
            "style": {
              stroke: true,
              weight: 1,
              color: "red",
              opacity: 1,
              fillColor: "#204B63",
              fillOpacity: 0.2
            }
        },
        "geometry": {
            "type": "<%= countryGeoJsonData['type']%>",
            "coordinates": <%= countryGeoJsonData['coordinates'].to_json %>
        }
    };
  var mapMarkers = {
      "type": "FeatureCollection",
      "features": <%= mapMarkers.to_json%>
    };
  function onEachFeature(feature, layer) {
    var popupContent = "";

    if (feature.properties && feature.properties.popupContent) {
      popupContent += feature.properties.popupContent;
    }

    layer.bindPopup(popupContent);
  }
  L.geoJSON([mapBorder, mapMarkers], {
    style: function (feature) {
      return feature.properties && feature.properties.style;
    },

    onEachFeature: onEachFeature,

    pointToLayer: function (feature, latlng) {
      return L.circleMarker(latlng, {
        radius: 6,
        fillColor: "red",
        color: "black",
        weight: 1,
        opacity: 1,
        fillOpacity: 0.3
      });
    }
  }).addTo(map);

  });
</script>