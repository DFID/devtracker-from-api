<div class="hero" style="margin-bottom: 0px">
  <%= erb :'partials/_location-title-bar'%>
  <%= erb :'partials/_location-tabs', :locals => { :active => "country" } %>
</div>
<!--[if lte IE 8]>
    <div class="row">
      <div class="disclaimer grey">
          <p>The interactive map functionality is not supported by your browser.</p>
      </div>
    </div>
<![endif]-->

<!--[if lte IE 8]><div class="hide-interactive-map"><![endif]-->
        <div class="row">
            <div class="twelve columns map">
                <script type="text/javascript">
                    var countriesData = <%= dfid_country_map_data %>;
                    var TotalCountryBudget = '<%= total_country_budget_location%>';
                    var finYear = '<%=current_financial_year%>';
                </script>  
<!--                <script src="http://maps.googleapis.com/maps/api/js?sensor=false"></script> -->
                <script src="/javascripts/leaflet/leaflet.js" type="text/javascript"></script>
                <script src="/javascripts/leaflet/leaflet-googlemaps.js"></script>
                <script src="/javascripts/leaflet/world.js" type="text/javascript"></script>
                <link rel="stylesheet" href="/javascripts/leaflet/leaflet.css" />
                <!--[if lte IE 8]><link rel="stylesheet" href="/javascripts/leaflet/leaflet.ie.css /><![endif]-->

                <div id="map" role="presentation">
                  <div style="position:absolute; bottom: 10px;z-index:999; left: 10px;">
                    <img src="/images/country-map-legend.png" style="Map Legend"/>
                    <!-- <h3>Current Projects: Total Project Budget for <%#=current_financial_year%></h3> -->
                  </div>
                </div>

                <div class="disclaimer grey">
                   <p><em>Disclaimer: </em>Country borders do not necessarily reflect the UK Government's official position.</p>
                </div>
                <script src="/javascripts/leaflet/indexmap.js" type="text/javascript"></script>
            </div>
        </div>
<!--[if lte IE 8]></div><![endif]-->

<!-- <div class="row">
  <div class="twelve columns">
    <h2 class="section-group-title">Countries with Active Projects</h2>
  </div>
</div> -->
<!-- <div class="row">
  <div id="country-list" class="twelve columns">
    <%# dfid_complete_country_list.each do |country| %>
      <a href="/countries/<%#=country["recipient_country"]["code"]%>"><%#= country["recipient_country"]["name"] %></a> | 
    <%# end %>    
  </div>
</div> --> 

<div class="row">
  <div id="country-list">
    <table id="dataTable" class="display" style="width: 100%; display: none">
      <thead>
          <tr>
              <th>Country</th>
              <th>Projects Active</th>
              <th>Project Budget</th>
              <th>Top Sector</th>
          </tr>
      </thead>
      <tbody>
        <%dfid_bottom_table_data.each do |key,val|%>
          <%if val["projects"] > 0 && val["budget"] > 0%>
            <tr>
              <td><a href="/countries/<%= val['id']%>"><%= val['country']%></a></td>
              <td><%= val['projects']%></td>
              <td><%= Money.new(val['budget'].to_f*100,"GBP").format(:no_cents_if_whole => true,:sign_before_symbol => false)%></td>
              <td>
              <% if sectorData.key?(key) %>
                <%= sectorData[key].first[1]['name']%> (<%= ((sectorData[key].first[1]['budget']*100)/val['budget']).round(3) %>%)
              <%end%>
            </td>
            </tr>
          <%end%>
        <%end%>
      </tbody>
    </table>
  </div>
</div> 
<script src="https://code.jquery.com/jquery-3.3.1.js" type="text/javascript"></script>
<script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">
<script type="text/javascript">
  $(document).ready(function() {
      $('#dataTable').DataTable({
        "info":     false
      });
      $('#dataTable').show();
  } );
</script>